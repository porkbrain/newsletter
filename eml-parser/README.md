# eml-parser
Parses email to text. The [library][mailparser] which performs this function is
more reliable than analogical Rust crates.

`eml-parser` [listens to SQS messages][s3-to-sqs] of newly stored S3 objects.
It fetches an object and uses [mailparser][mailparser] to extract body from the
MIME file. Then it stores the email information in an SQLite database and the
HTML in an another S3 bucket. This action triggers next service in line, the
`prtsc`, via the same mechanism.

## S3 email key
We store the S3 bucket object name in db. The S3 object name is a random string
generated by the SES when storing the email as a file or hash of the email (for
example: `7gfmhp045dv9hfst94stsrfr8mieseafn6b0ce01`). It is used throughout the
system for identification of a single newsletter.


<!-- References -->
[mailparser]: https://www.npmjs.com/package/mailparser
[s3-to-sqs]: https://docs.aws.amazon.com/AmazonS3/latest/dev/ways-to-add-notification-config-to-bucket.html
